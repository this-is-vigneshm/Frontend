<div id="create-asset-body" >
  <div id="create-asset-form">
    <div style="display: flex; margin-left: 69px; margin-top: 5px">
      <div>
        <span
          ><img
            src="../../../assets/AssetsImg.png"
            width="35px"
            height="35px"
            style="margin-top: 14px"
        /></span>
      </div>
      <div style="margin-left: 20px">
        <span>
          <h2
            style="
              margin-top: -1px;
              color: rgba(38, 38, 202, 0.733);
              font-size: 20pt;
              font-weight: 700;
            "
          >
            Create a Ticket
          </h2>
          <h4 style="margin-top: -17px; margin-right: 20px">
            This is the Ticket creation page!
          </h4></span
        >
      </div>
    </div>

<form nz-form [formGroup]="form" nzLayout="vertical" (ngSubmit)="submitForm()" style="text-align: left;">
<nz-form-item>
    <nz-form-label style="color: #3253dc;" nzRequired nzFor="title">
      <span style="color: #3253dc;">What is the Maintanence Issue that needs attention?</span>
       </nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24" nzErrorTip="Please Enter the Title">
      <input nz-input formControlName="title" id="ticket-title" placeholder="Brief Title" />
    </nz-form-control>
  </nz-form-item>

  <nz-form-item >
    <nz-form-label style="color: #3253dc;" nzRequired nzFor="userId">
      <span style="color: #3253dc;">Raise this request on behalf of?</span>
    </nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24" nzErrorTip="Please Choose the Employee Name">
      <nz-select nz-input formControlName="userId" id="userId" nzShowSearch nzAllowClear
        nzPlaceHolder="Select an Employee">
        <nz-option *ngFor="let employee of employees" [nzLabel]="employee.name + '  (' + employee.email + ')' "
          [nzValue]="employee.id">{{employee.name
          + employee.employeeMail}}</nz-option>
      </nz-select>
    </nz-form-control>
  </nz-form-item>


  <nz-form-item>
    <nz-form-label style="color: #3253dc;" nzRequired nzFor="employeeId">
      <span style="color: #3253dc;">Assign this request to?</span>
    </nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24" nzErrorTip="Please Choose the Employee Name">
      <nz-select nz-input formControlName="employeeId" id="employeeId" nzShowSearch nzAllowClear
        nzPlaceHolder="Select an Employee">
        <nz-option *ngFor="let employee of employees" [nzLabel]="employee.name + '  (' + employee.email + ')' "
          [nzValue]="employee.id">{{employee.name
          + employee.employeeMail}}</nz-option>
      </nz-select>
    </nz-form-control>
  </nz-form-item>

  

  <nz-form-item>
    <nz-form-label style="color: #3253dc;" nzRequired nzFor="category">
      <span style="color: #3253dc;">How serious is the issue?</span></nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24" nzErrorTip="Please Select a Category">
      <nz-select nz-input formControlName="category" id="category" nzShowSearch nzAllowClear
        nzPlaceHolder="Select a Category" (ngModelChange)="onStatusChange($event)">
        <nz-option *ngFor="let category of categories" [nzLabel]="category.name +  ' (' + category.value + ')'"
          [nzValue]="category.value" ></nz-option>
      </nz-select>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-label style="color: #3253dc;" nzRequired nzFor="category">
      <span style="color: #3253dc;">Estimated Completion Time</span></nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24" style="font-weight: 600;">
      {{expectedTime | date: 'dd/MM/yyyy hh:ss a'}} ({{expectedTimeText}}) 
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-label nzRequired nzFor="issueType">
      <span style="color: #3253dc;">What Type of Maintanence issue is it?</span>
    </nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24" nzErrorTip="Please Select a Issue Type">
      <nz-select nz-input formControlName="issueType" id="issueType" nzShowSearch nzAllowClear
        nzPlaceHolder="Select the issue Type">
        <nz-option *ngFor="let issue of issueTypes" [nzLabel]="issue" [nzValue]="issue"></nz-option>
      </nz-select>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-label nzFor="assetId"> 
      <span style="color: #3253dc;">Which is the asset that you have problem with?</span>
    </nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24">
      <!-- <input nz-input formControlName="assetId" id="ticket-assetId" [(ngModel)]="assetId" placeholder="Asset Id" /> -->
      <nz-select nz-input formControlName="assetId" id="assetId" nzShowSearch nzAllowClear
        nzPlaceHolder="Select the Asset">
        <nz-option *ngFor="let asset of assetList" [nzLabel]="asset.name +  ' (' + asset.id + ')'"
           [nzValue]="asset.id"></nz-option>
      </nz-select>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-label style="color: #3253dc;" nzFor="description" nzRequired>
      <span style="color: #3253dc;">What are the details of the maintenance issue?</span>
    </nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24" nzErrorTip="Please Enter the description ( 20 - 200 characters)">
      <nz-textarea-count [nzMaxCharacterCount]="200">
        <textarea rows="5" formControlName="description" nz-input></textarea>
      </nz-textarea-count>
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-label nzFor="file"><span style="color: #3253dc;">Attach a photo of the Maintanence Issue!</span></nz-form-label>
    <nz-form-control [nzSm]="19" [nzXs]="24"  nzErrorTip="Please Add an Attachment">
      <!-- <span>Click here or drag your File to upload</span> -->
      <input type="file" id="file" placeholder="File" (change)="onChange($event)">
    </nz-form-control>
  </nz-form-item>


  <nz-form-item>
    <nz-form-label style="color: #3253dc;" nzFor="workorder">
      <span style="color: #3253dc; padding-right: 20px;">Is workorder is needed?</span>
    
    <label  nz-checkbox [(ngModel)]="radioValue" formControlName="radio"> </label>
    
  </nz-form-label>
  <br>
  <nz-form-item nz-row class="register-area">
    <nz-form-control [nzSpan]="14" [nzOffset]="6">
      <div *ngIf="radioValue" style="width: 400px;margin-left : -100px"><button nz-button nzType="primary" id="resource">Create Ticket and Add New</button>
    
        <span style="padding: 15px;"></span>
      <button nz-button nzType="primary" id="resource" (click)="showModal()" (click)="disable($event)">Add Existing</button>
    </div>
    <div *ngIf="!radioValue" style = "margin-left:15%"><button nz-button nzType="primary" (click)="onUpload()" id="create-ticket-submit">Create a Ticket</button></div>

    </nz-form-control>
  </nz-form-item>

    
 Â </nz-form-item>

</form>

<nz-modal
    nzWidth = "1200px"
      [(nzVisible)]="isVisible"
      [nzTitle]="modalTitle"
      [nzFooter]="modalFooter"
      (nzOnCancel)="handleCancel()"
    >
      <ng-template #modalTitle>Create WorkOrder</ng-template>

      <ng-container *nzModalContent>
        <app-create-workorder [ticketid]="data.uuid" (done)="get($event)"></app-create-workorder>
      </ng-container>

      <ng-template #modalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
        <button nz-button nzType="primary" (click)="handleOk()" [nzLoading]="isConfirmLoading">Ok</button>
      </ng-template>
    </nz-modal>

    <nz-modal
    nzWidth = "1200px"
    [(nzVisible)]="isVisibleExisting"
    [nzTitle]="modalTitle"

    [nzFooter]="modalFooter"
    (nzOnCancel)="handleCancel()"
  >
    <ng-template #modalTitle>Select a Existing WorkOrder</ng-template>

    <ng-container *nzModalContent>
      <app-myworkorder (worKOrderId)="handleTicketCreation($event)"></app-myworkorder>
    </ng-container>


    <ng-template #modalFooter>
      <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
      <button nz-button nzType="primary" (click)="handleOk()" [nzLoading]="isConfirmLoading">Ok</button>
    </ng-template>
  </nz-modal>